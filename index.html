<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>El Telescopio de las Estrellas</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background: black;
            color: white;
            overflow: hidden;
            text-align: center;
        }
        canvas {
            position: absolute;
            top: 0;
            left: 0;
        }
        .container {
            position: relative;
            z-index: 2;
            max-width: 90%;
        }
        h1 {
            font-size: 2rem;
            margin-bottom: 1rem;
        }
        p {
            font-size: 1.2rem;
            margin-bottom: 1.5rem;
        }
    </style>
</head>
<body>
    <canvas id="starCanvas"></canvas>
    <div class="container">
        <h1>El Telescopio de las Estrellas</h1>
        <p>Usa tu móvil para explorar las estrellas y encontrar el objeto oculto. Solo tienes 3 intentos.</p>
        <p id="status">Intentos restantes: 3</p>
    </div>

    <script>
        const canvas = document.getElementById('starCanvas');
        const ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        const stars = [];
        const starCount = 500;
        const targetStarIndex = Math.floor(Math.random() * starCount);
        let attemptsLeft = 3;

        for (let i = 0; i < starCount; i++) {
            stars.push({
                x: Math.random() * 360,
                y: Math.random() * 360,
                size: i === targetStarIndex ? 5 : Math.random() * 2 + 1,
                unique: i === targetStarIndex
            });
        }

        function drawStars(alpha, beta, gamma) {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.fillStyle = 'white';

            stars.forEach(star => {
                const x = (canvas.width / 2) + (star.x - alpha) * 10;
                const y = (canvas.height / 2) + (star.y - beta) * 10;

                if (x > 0 && x < canvas.width && y > 0 && y < canvas.height) {
                    ctx.beginPath();
                    ctx.arc(x, y, star.size, 0, Math.PI * 2);
                    ctx.fill();
                }
            });
        }

        function handleTouch(event) {
            if (attemptsLeft <= 0) return;

            const touchX = event.touches[0].clientX;
            const touchY = event.touches[0].clientY;

            const targetStar = stars[targetStarIndex];
            const targetX = (canvas.width / 2) + (targetStar.x - currentAlpha) * 10;
            const targetY = (canvas.height / 2) + (targetStar.y - currentBeta) * 10;

            const distance = Math.sqrt((touchX - targetX) ** 2 + (touchY - targetY) ** 2);

            if (distance < 20) {
                document.getElementById('status').textContent = '¡Encontraste la estrella especial!';
                document.getElementById('status').style.color = 'yellow';
            } else {
                attemptsLeft--;
                if (attemptsLeft > 0) {
                    document.getElementById('status').textContent = `Intentos restantes: ${attemptsLeft}`;
                } else {
                    document.getElementById('status').textContent = '¡Te quedaste sin intentos!';
                    document.getElementById('status').style.color = 'red';
                }
            }
        }

        let currentAlpha = 0;
        let currentBeta = 0;
        let currentGamma = 0;

        if (window.DeviceOrientationEvent) {
            window.addEventListener('deviceorientation', (event) => {
                currentAlpha = event.alpha || 0;
                currentBeta = event.beta || 0;
                currentGamma = event.gamma || 0;
                drawStars(currentAlpha, currentBeta, currentGamma);
            });
        } else {
            document.getElementById('status').textContent = 'Tu dispositivo no soporta detección de orientación.';
        }

        canvas.addEventListener('touchstart', handleTouch);
    </script>
</body>
</html>
